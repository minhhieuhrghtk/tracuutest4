<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Tra c·ª©u b√†n ti·ªác</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      font-family: "Segoe UI", Tahoma, sans-serif;
      background: linear-gradient(135deg, #dcfce7, #bbf7d0);
      min-height: 100vh;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      background: #fff;
      max-width: 520px;
      width: 100%;
      border-radius: 24px;
      box-shadow: 0 25px 50px rgba(0,0,0,0.15);
      overflow: hidden;
    }

    header {
      background: linear-gradient(135deg, #16a34a, #22c55e);
      color: white;
      padding: 20px;
      text-align: center;
    }

    .content { padding: 20px; }

    input, button {
      width: 100%;
      box-sizing: border-box;
      padding: 12px 14px;
      font-size: 16px;
      border-radius: 14px;
      border: 1px solid #d1fae5;
    }

    button {
      margin-top: 8px;
      background: linear-gradient(135deg, #16a34a, #4ade80);
      color: white;
      border: none;
      font-weight: 600;
      cursor: pointer;
    }

    .result {
      margin-top: 10px;
      padding: 10px;
      background: #ecfdf5;
      border-radius: 12px;
      text-align: center;
      font-size: 15px;
    }

    .note {
      margin-top: 10px;
      font-size: 13px;
      background: #ecfdf5;
      border-left: 4px solid #22c55e;
      padding: 8px 10px;
      border-radius: 8px;
      color: #14532d;
    }

    /* ===== S∆† ƒê·ªí ===== */
    .hall {
      margin-top: 18px;
      padding: 14px;
      border: 3px dashed #22c55e;
      border-radius: 20px;
      background: #f0fdf4;
      transform: scale(0.85);
      transform-origin: top center;
    }

    .stage {
      background:#15803d;
      color:white;
      text-align:center;
      padding:8px;
      border-radius:12px;
      font-weight:700;
      margin-bottom: 8px;
    }

    .entrance {
      background:#facc15;
      text-align:center;
      padding:8px;
      border-radius:12px;
      margin-top:14px;
      font-weight:700;
    }

    .row {
      display:flex;
      align-items:center;
      margin: 14px 0;
    }

    .row-label {
      width:50px;
      font-size:12px;
      font-weight:600;
      color:#166534;
    }

    .lanes {
      display:flex;
      flex:1;
      justify-content:center;
      gap:22px;
    }

    .table {
      width:60px;
      height:36px;
      background:#dcfce7;
      border-radius:10px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:14px;
      font-weight:600;
      color:#166534;
      cursor:pointer;
      transition: all 0.25s ease;
    }

    .table.highlight {
      background:#22c55e;
      color:white;
      box-shadow:0 0 16px rgba(34,197,94,0.9);
      animation:pulse 1.2s infinite;
    }

    @keyframes pulse {
      0% { transform:scale(1); }
      50% { transform:scale(1.12); }
      100% { transform:scale(1); }
    }

    .guest-list {
      margin-top: 10px;
      background:#f0fdf4;
      border-radius:12px;
      padding:10px;
      display:none;
    }

    .guest-list h4 {
      margin:0 0 6px;
      color:#166534;
      font-size:14px;
    }

    .guest-item {
      font-size:13px;
      padding:4px 0;
      border-bottom:1px dashed #bbf7d0;
    }
  </style>
</head>
<body>
<div class="container">
  <header>
    <h3>üåø Tra c·ª©u b√†n ti·ªác</h3>
    <p>Nh·∫≠p t√™n ƒë·ªÉ xem v·ªã tr√≠</p>
  </header>

  <div class="content">
    <input id="username" style="margin-bottom:8px" placeholder="V√≠ d·ª•: an, binh..." onkeydown="if(event.key==='Enter') traCuu()" />
    <button onclick="traCuu()">Tra c·ª©u</button>

    <div id="result" class="result"></div>
    <div class="note">üìå <b>L∆∞u √Ω:</b> Vui l√≤ng <b>ch·ª•p m√†n h√¨nh</b> sau khi tra c·ª©u ƒë·ªÉ ti·ªán ƒë·ªëi chi·∫øu khi v√†o s·∫£nh.</div>
    <div id="guestList" class="guest-list"></div>

    <div class="hall">
      <div class="stage">S√ÇN KH·∫§U</div>

      <div class="row"><div class="row-label">H1</div><div class="lanes">
        <div class="table" data-ban="3">3</div>
        <div class="table" data-ban="1">1</div>
        <div class="table" data-ban="2">2</div>
        <div class="table" data-ban="4">4</div>
      </div></div>

      <div class="row"><div class="row-label">H2</div><div class="lanes">
        <div class="table" data-ban="5">5</div><div class="table" data-ban="6">6</div><div class="table" data-ban="7">7</div>
      </div></div>
      <div class="row"><div class="row-label">H3</div><div class="lanes">
        <div class="table" data-ban="8">8</div><div class="table" data-ban="9">9</div><div class="table" data-ban="10">10</div>
      </div></div>
      <div class="row"><div class="row-label">H4</div><div class="lanes">
        <div class="table" data-ban="11">11</div><div class="table" data-ban="12">12</div><div class="table" data-ban="13">13</div>
      </div></div>
      <div class="row"><div class="row-label">H5</div><div class="lanes">
        <div class="table" data-ban="14">14</div><div class="table" data-ban="15">15</div><div class="table" data-ban="16">16</div>
      </div></div>
      <div class="row"><div class="row-label">H6</div><div class="lanes">
        <div class="table" data-ban="17">17</div><div class="table" data-ban="18">18</div><div class="table" data-ban="19">19</div>
      </div></div>
      <div class="row"><div class="row-label">H7</div><div class="lanes">
        <div class="table" data-ban="20">20</div><div class="table" data-ban="21">21</div><div class="table" data-ban="22">22</div>
      </div></div>
      <div class="row"><div class="row-label">H8</div><div class="lanes">
        <div class="table" data-ban="23">23</div><div class="table" data-ban="24">24</div><div class="table" data-ban="25">25</div>
      </div></div>

      <div class="entrance">C·ª¨A RA V√ÄO</div>
    </div>
  </div>
</div>

<script>
  /* ====== THAY LINK CSV GOOGLE SHEET C·ª¶A B·∫†N ====== */
  const SHEET_URL = "PASTE_GOOGLE_SHEET_CSV_URL_HERE";

  const userMap = {};
  const guestsByTable = {};

  fetch(SHEET_URL)
    .then(res => res.text())
    .then(text => {
      text.trim().split(/\r?\n/).forEach(line => {
        const [user, ban, lucky, arrived] = line.split(',');
        if (!user || !ban) return;

        const u = user.trim();
        const b = ban.trim();
        const l = lucky ? lucky.trim() : '';

        userMap[u.toLowerCase()] = { ban: b, lucky: l, arrived: arrived === '1' };()] = { ban: b, lucky: l };
        if (!guestsByTable[b]) guestsByTable[b] = [];
        guestsByTable[b].push(u);
      });
    });

  document.querySelectorAll('.table').forEach(t => {
    t.addEventListener('click', () => showGuests(t.dataset.ban));
  });

  function traCuu() {
    document.querySelectorAll('.table').forEach(t => t.classList.remove('highlight'));
    document.getElementById('guestList').style.display = 'none';

    const user = document.getElementById('username').value.trim().toLowerCase();
    const info = userMap[user];

    if (!info) {
      document.getElementById('result').innerHTML = '‚ùå Kh√¥ng t√¨m th·∫•y th√¥ng tin';
      return;
    }

    const ban = info.ban;
    const lucky = info.lucky;

    const table = document.querySelector(`.table[data-ban="${ban}"]`);
    if (table) table.classList.add('highlight');

    document.getElementById('result').innerHTML = `üéâ <b>${user}</b> ‚Äì B√†n <b>${ban}</b><br>üçÄ S·ªë may m·∫Øn: <b>${lucky || '‚Äî'}</b><br>üëâ Nh·∫•n v√†o b√†n ƒë·ªÉ xem danh s√°ch kh√°ch`;
  }

  function showGuests(ban) {
    const list = guestsByTable[ban] || [];
    const box = document.getElementById('guestList');

    box.innerHTML = `<h4>üë• Kh√°ch b√†n ${ban}</h4>` + list.map(n => `<div class="guest-item">‚Ä¢ ${n}</div>`).join('');
    box.style.display = 'block';
  }
</script>
</body>
</html>
